<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Agenda</title>
    <style>
        @page {
            size: A4 landscape; /* Define a página como paisagem */
            margin: 1.5cm;
        }
        body {
            font-family: Arial, sans-serif;
            font-size: 9pt;
            color: #333;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .header img {
            max-height: 60px;
        }
        .header h1 {
            margin: 0;
            font-size: 18pt;
        }
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed; /* Garante que as colunas tenham a mesma largura */
        }
        .calendar-table th {
            background-color: #f2f2f2;
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
        }
        .calendar-table td {
            height: 120px; /* Altura de cada célula do dia */
            border: 1px solid #ddd;
            vertical-align: top;
            padding: 4px;
            overflow: hidden;
        }
        .day-number {
            font-weight: bold;
            text-align: right;
            margin-bottom: 5px;
        }
        /* Estilo para os dias que não pertencem ao mês atual */
        .other-month .day-number {
            color: #ccc;
        }
        .event {
            font-size: 8pt;
            margin-bottom: 4px;
            line-height: 1.3;
        }
        .event-time {
            font-weight: bold;
        }
        /* Adiciona quebra de página antes de cada novo mês, exceto o primeiro */
        .month-container:not(:first-child) {
            page-break-before: always;
        }
    </style>
</head>
<body>

{% for mes in meses_do_relatorio %}
    <div class="month-container">
        <header class="header">
            <img src="{{ logo_siga_url }}" alt="Logo SIGA">
            <h1>{{ mes.nome_mes }}</h1>
            <img src="{{ logo_gestao_url }}" alt="Logo Gestão">
        </header>

        <table class="calendar-table">
            <thead>
                <tr>
                    <th>Dom</th>
                    <th>Seg</th>
                    <th>Ter</th>
                    <th>Qua</th>
                    <th>Qui</th>
                    <th>Sex</th>
                    <th>Sáb</th>
                </tr>
            </thead>
            <tbody>
                {% for semana in mes.semanas %}
                <tr>
                    {% for dia in semana %}
                        {# Verifica se o dia pertence ao mês atual para aplicar o estilo correto #}
                        {% with mes_atual=mes.semanas.1.0.data.month %}
                        <td class="{% if dia.data.month != mes_atual %}other-month{% endif %}">
                            <div class="day-number">{{ dia.data.day }}</div>
                            <div class="events">
                                {% for evento in dia.eventos %}
                                    <div class="event">
                                        <span class="event-time">{{ evento.data_agendada|date:"H:i" }}</span> -
                                        {{ evento.assunto }}
                                    </div>
                                {% endfor %}
                            </div>
                        </td>
                        {% endwith %}
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endfor %}

</body>
</html>